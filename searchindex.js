Search.setIndex({docnames:["advanced","amp","fp16_utils","index","layernorm","optimizers","parallel"],envversion:{"sphinx.domains.c":1,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":1,"sphinx.domains.javascript":1,"sphinx.domains.math":2,"sphinx.domains.python":1,"sphinx.domains.rst":1,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":1,"sphinx.ext.viewcode":1,sphinx:56},filenames:["advanced.rst","amp.rst","fp16_utils.rst","index.rst","layernorm.rst","optimizers.rst","parallel.rst"],objects:{"apex.amp":{initialize:[1,1,1,""],master_params:[1,1,1,""],scale_loss:[1,1,1,""]},"apex.fp16_utils":{DynamicLossScaler:[2,2,1,""],FP16_Optimizer:[2,2,1,""],LossScaler:[2,2,1,""],master_params_to_model_params:[2,1,1,""],model_grads_to_master_grads:[2,1,1,""],prep_param_lists:[2,1,1,""]},"apex.fp16_utils.FP16_Optimizer":{backward:[2,3,1,""],clip_master_grads:[2,3,1,""],inspect_master_grad_data:[2,3,1,""],load_state_dict:[2,3,1,""],state_dict:[2,3,1,""],step:[2,3,1,""],update_master_grads:[2,3,1,""],zero_grad:[2,3,1,""]},"apex.normalization":{FusedLayerNorm:[4,2,1,""]},"apex.normalization.FusedLayerNorm":{extra_repr:[4,3,1,""],forward:[4,3,1,""]},"apex.optimizers":{FusedAdam:[5,2,1,""],FusedLAMB:[5,2,1,""],FusedNovoGrad:[5,2,1,""],FusedSGD:[5,2,1,""]},"apex.optimizers.FusedAdam":{step:[5,3,1,""]},"apex.optimizers.FusedLAMB":{step:[5,3,1,""],zero_grad:[5,3,1,""]},"apex.optimizers.FusedNovoGrad":{step:[5,3,1,""],zero_grad:[5,3,1,""]},"apex.optimizers.FusedSGD":{step:[5,3,1,""]},"apex.parallel":{DistributedDataParallel:[6,2,1,""],Reducer:[6,2,1,""],SyncBatchNorm:[6,2,1,""],convert_syncbn_model:[6,1,1,""]},"apex.parallel.DistributedDataParallel":{forward:[6,3,1,""]},"apex.parallel.SyncBatchNorm":{forward:[6,3,1,""]},apex:{amp:[1,0,0,"-"],fp16_utils:[2,0,0,"-"],normalization:[4,0,0,"-"],optimizers:[5,0,0,"-"],parallel:[6,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","method","Python method"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:method"},terms:{"1e7":6,"1st":5,"2nd":5,"boolean":[4,5,6],"case":[0,2,5],"catch":6,"class":[0,1,2,4,5,6],"default":[0,1,2,4,5,6],"final":2,"float":[0,1,2,5,6],"function":[1,4],"import":[2,5,6],"int":[1,2,4,5,6],"long":[0,1,2],"new":[1,2],"return":[0,1,2,5],"static":[1,2],"switch":[1,6],"true":[0,1,2,4,5,6],"try":1,"var":4,"while":[1,4,6],But:0,For:[0,2,6],NOT:5,One:1,The:[0,1,2,3,4,5,6],These:[0,1,2,5],Use:2,With:4,__init__:0,_batchnorm:6,about:0,abov:[0,1,2],acceler:1,accept:[0,1,2,4],access:[0,1,2],accommod:0,accompani:1,accomplish:0,accord:1,accordingli:1,accumul:[1,2],accuraci:[1,6],achiev:[1,6],acoust:5,across:[1,6],act:1,activ:[1,4],adam:5,adam_w_mod:5,adamw:5,adapt:1,add:1,added:[4,5,6],addit:[0,1,2,5,6],adher:1,adjust:[1,2],advanc:2,affect:[1,2],affin:[4,6],after:[0,1,2,6],afterward:[4,6],again:1,against:[1,2],algorithm:5,all:[0,1,2,4,5,6],allow:[1,2,5,6],allreduc:6,allreduce_always_fp32:6,allreduce_commun:6,allreduce_trigger_param:6,alreadi:[0,1],also:[0,1,2,5,6],although:[1,2,4,6],alwai:[1,2,6],amp:[3,5],amp_handl:1,amsgrad:5,analog:[2,5],ani:[0,1,2,5,6],annoi:[1,2],annot:1,anoth:[1,2,6],anyth:1,api:[0,3],appli:[1,2,4,5,6],applic:[1,6],appropri:[0,1],arbitrari:1,arg:[1,2,6],argument:[0,1,2,5,6],around:[1,6],asid:1,aspect:1,assign:0,associ:[0,2],assum:[0,2,6],attempt:[0,1,2],attribut:[1,2],autograd:1,automat:[1,3,6],avail:3,averag:[0,5,6],back:6,backward:[1,2,5,6],base:[0,1,5],baselin:1,batch:[1,4,5,6],batch_norm:6,batchnorm:[1,6],batchnormnd:6,batchsiz:6,becaus:[0,1,2],becom:[0,1,2],been:[0,2,5],befor:[0,1,2,6],begin:[1,2,6],behav:[1,2],behavior:2,being:[1,2,6],belong:2,below:[0,1,2],benefici:1,benefit:1,bert:5,best:1,beta2:5,beta:[4,5],between:1,beyond:5,bia:4,bias:4,bias_correct:5,blacklist:1,bodi:1,bool:[1,2,5,6],both:[1,4,6],broadcast:6,bucket:6,buffer:1,build:1,cach:5,calcul:[4,5],call:[0,1,2,4,5,6],callabl:5,came:[2,6],can:[0,1,2,3,5,6],cannot:1,captur:1,care:[2,4,6],carri:6,cast:[0,1],cast_model_output:1,cast_model_typ:1,castabl:0,ceil:1,certain:[2,4],chang:[1,2],channel:[4,6],channel_last:6,check:[0,1,2,5],checkpoint:2,children:6,choos:[1,2,5],chosen:1,cleanup:6,clear:5,clip:[1,2,5],clip_grad_norm:2,clip_grad_norm_:0,clip_grad_value_:0,clip_master_grad:2,closur:[2,5],code:[0,1,3],coeffici:5,coincid:0,collect:[0,6],com:[1,3,6],combat:2,combin:[1,6],commonli:1,commun:6,compar:1,compat:2,comprehens:[0,1],comput:[2,4,5,6],conceptu:2,conjunct:1,consecut:2,consid:[0,5],construct:[0,1,2],constructor:[2,6],contain:[0,2,3,6],context:[0,1],contrast:5,control:[1,2,6],converg:[5,6],convers:1,convert:[1,2,6],convert_syncbn_model:6,convolut:[1,5],copi:[1,2],core:1,correct:[0,2],correspond:[1,2],could:1,cpp_ext:5,creat:[0,1,2,6],criterion:2,cross:[1,2],cuda:[0,1,2,4,6],cuda_ext:5,cudnn:1,cumul:6,current:[0,1,2,4,5],custom:[1,4],customdata:0,d_in:[1,2],d_out:[1,2],dampen:5,data:[1,2,4,6],dataset:2,date:3,dcgan:1,ddp:6,decai:5,declar:1,decoupl:5,deep:5,def:[0,2],defin:[1,2,4,5,6],definit:6,delai:[2,6],delay_allreduc:6,delay_overflow_check:1,delay_unscal:[0,1],delet:1,demo:2,demonstr:[1,2],denomin:[4,5,6],denot:5,depend:[0,2],deprec:[1,5],descent:5,describ:4,design:[2,6],desir:1,detail:[1,2,6],detect:2,deviat:4,devic:0,dict:[2,5],differ:[1,2,5],dimens:[4,6],diminish:6,dir:5,direct:1,directli:[0,1,2],disabl:[1,2,6],distinct:0,distribut:[1,2,3,6],distributeddataparallel:[1,2,6],diverg:0,divid:[0,2],divis:6,docstr:2,document:[1,3],doe:[0,1,6],doesn:[0,1],doing:[0,1],don:[0,1],downscal:2,dpython:1,drawn:6,drill:0,drop:5,dtype:[0,1],dure:[0,1,2,6],duti:1,dynam:[1,2,6],dynamic_loss_arg:2,dynamic_loss_scal:[1,2],dynamiclossscal:2,each:[0,1,2,4,5],earlier:[1,2],easi:6,easier:1,easili:[1,6],edg:2,effect:[1,6],effici:2,either:[1,2,6],element:[1,2,4,6],elementwis:5,elementwise_affin:4,elimin:2,els:[0,1],emploi:5,enabl:[1,2,5,6],encount:2,encourag:[0,1],end:[2,5,6],enhanc:1,ensur:1,entir:4,entranc:1,entropi:2,epoch:2,eps:[4,5,6],epsilon:4,equival:1,error:[1,5],especi:1,establish:1,etc:2,eval:6,evalu:[4,6],even:[0,1],eventu:3,everi:[0,4,6],everyth:1,exactli:1,exampl:[0,1,2,4,5,6],exhaust:1,exist:[1,2],exit:[0,1],expect:[1,2,4,6],experi:1,explain:1,explan:1,explicit:1,expos:1,exposur:0,express:[0,1],extent:6,extra:4,extra_repr:4,factor:[2,5],fall:6,fals:[1,2,4,5,6],few:5,file:[1,2],finer:1,finish:1,first:[2,5,6],fix:1,flag:1,flat_mast:2,flatten:2,flexibl:0,float16:[0,1],float32:[0,1],floattensor:0,floor:1,flow:[1,2],fly:1,follow:[0,1,2],foral:2,form:5,format:1,former:[4,6],formerli:1,formula:5,forward:[0,1,2,4,6],found:[1,2,3],fp16:[0,2,6],fp16_optim:2,fp16_optimizer_inst:2,fp16_optimizer_obj:2,fp16_util:1,fp32:[0,2,6],fp32_loss:2,frac:4,framework:5,free:1,fresh:2,friendli:1,from:[0,1,2,4,5,6],full:[2,6],fulli:0,further:1,fuse:[3,5],fuse_relu:6,fused_layer_norm:3,fusedadam:5,fusedlamb:5,fusedlayernorm:4,fusednovograd:5,fusedsgd:5,fusion:5,futur:1,gamma:4,gan:1,gemm:1,gener:[0,1,2,5],generaliz:0,github:[1,2,3,5,6],give:[0,1,6],given:[0,1,2,6],global:[0,1,5],good:1,gotcha:1,govern:1,gpu:[5,6],grad:[1,2,5,6],grad_averag:5,grad_norm:5,gradient:[1,2,5,6],gradient_averag:6,gradient_average_split_factor:6,gradient_predivide_factor:6,grain:1,group:[2,5,6],gtc:2,guarante:[0,2],had:1,half:[1,2],hand:1,handl:2,has:[0,2,4,5,6],have:[1,2,4],help:[1,6],here:[1,3],high:[2,6],higher:2,highest:2,honor:1,hood:[0,1],hook:[4,6],host:0,how:[0,1,2],howev:[0,1,2],html:5,http:[1,3,5,6],hyperparamet:2,ident:[2,5],ignor:[1,4,6],illustr:1,imagenet:[1,2,6],immedi:2,implement:[1,2,5],impos:1,improv:[1,5,6],includ:[3,5],incom:[0,1],increas:[0,2,6],incur:2,index:3,indirectli:2,inf:[1,2],infer:1,infin:2,infinit:5,info:5,inform:[2,4],ingest:2,init:[1,5],init_optim:2,init_scal:2,init_zero:5,initi:[1,2,4,5,6],inp:6,input:[0,1,2,4,5,6],insert:1,inspect:2,inspect_master_grad_data:2,instal:[3,5],instanc:[0,2,4,6],instead:[0,1,4,6],instruct:[0,1,3],integ:[1,4],intend:[1,2,6],intent:[0,3],interact:[0,2],interest:0,intern:2,interpret:1,inttensor:0,invoc:[0,1],invok:0,iron:2,isn:1,issu:1,iter:[1,2,5,6],iters_to_accumul:0,its:[1,5,6],jasper:5,juici:0,just:[0,1],keep:1,keep_batchnorm_fp32:1,kei:2,kernel:5,keyword:1,kick:6,know:[0,1],known:5,kwarg:[1,2,6],lamb:5,larg:[2,5],larger:0,last:[4,6],later:[0,1,2],latter:[4,6],launch:[5,6],launcher:6,layer:[3,4,5,6],ldot:4,learn:[2,5],learnabl:[4,6],leav:2,left:1,legal:0,less:2,let:[1,6],level:[0,1],light:1,like:[0,1,6],line:[1,2,4],linear:[1,2],list:[0,1,2,4,6],live:1,load:2,load_state_dict:2,logic:0,longer:[1,2],loss0:0,loss1:[0,2],loss2:[0,2],loss:[1,5],loss_fn:[2,5],loss_id:[0,1],loss_scal:[1,2],lossscal:2,lot:1,lower:2,made:2,mai:[0,1,2,5],maintain:[0,1,3],make:[1,3,6],manag:[0,1],mani:[0,1],manipul:2,manner:2,manual:[0,1,6],map:6,master:[0,1,6],master_param:[0,1,2],master_params_to_model_param:2,master_weight:1,match:[0,1,2],materialize_master_grad:5,mathrm:4,matter:1,max:2,max_:0,max_grad_norm:5,max_loss_scal:1,max_norm:[0,2],maximum:2,mean:[1,2,4,6],meat:0,message_s:6,method:[0,1,4,5],might:2,min_loss_scal:1,mini:[4,6],minibatch:2,minimum:6,minor:[0,1],minut:5,mix:[2,3,6],mixtur:2,mode:[1,4,6],model0:0,model1:[0,1],model2:1,model:[1,2,5,6],model_grads_to_master_grad:2,model_param:2,modifi:[1,2,5],modul:[1,2,3,4,6],module_or_grads_list:6,moment:5,momentum:[5,6],more:[1,2,5],most:[0,2],move:[0,1,6],mse:2,mul_:6,multi:[4,5,6],multi_gpu:2,multipl:[1,2,6],multiprocess:6,must:[0,1,2],naiv:2,name:[1,2],namespac:1,nan:1,nccl:6,ndarrai:0,necessari:[1,2],need:[0,1,2,4,6],neither:1,nesterov:5,network:[2,6],neural:[2,5],never:[0,1],new_loss_scal:2,newli:[0,2],ninja:1,node:6,non:0,none:[1,2,5,6],nonintuit:2,norm:[2,3,5],norm_typ:[2,5],normal:[1,3,6],normalized_shap:4,note:[0,2],novograd:5,now:[0,1,5],nproc_per_nod:6,num_allreduce_stream:6,num_featur:6,num_loss:[0,1],number:[0,1,2,4,5,6],numer:[0,4,5,6],numpi:0,nvidia:[1,2,3,5,6],object:[0,2],occur:[0,2],off:6,often:1,old:0,omit:6,onc:[1,2],one:[0,1,2,4,5,6],ones:[2,4],onli:[0,1,2,4,5],openseq2seq:5,oper:[2,5],oppos:6,ops:1,opt:[0,1,5],opt_level:[0,5],optim0:0,optim1:[0,1],optim2:1,optim:[1,2,3,6],option:[1,2,4,5,6],ordinari:[2,5],organ:2,origin:[0,1,2],orthogon:2,other:[1,2,5],otherwis:0,out:[1,2,6],output:[0,1,2,4],output_param:5,outsid:0,over:[0,1,2,4,6],overflow:2,overlap:6,overrid:[1,2],overridden:[1,4,6],own:[0,1,4],ownership:2,packag:6,page:[1,2],paper:[4,5],parallel:[2,3],param:[0,1,5],param_group:[0,1,2],paramet:[0,1,4,5,6],partial:[0,6],particip:6,particular:[1,2],pass:[1,2,4,6],patch:[0,1],patch_torch_funct:1,pattern:0,penalti:5,peopl:1,per:[1,4,6],perfom:6,perform:[0,1,2,4,5,6],permiss:1,pip:5,place:[1,2],plan:[0,1],plane:4,pleas:1,point:[0,1],possibl:[0,1,2,3],post:6,potenti:1,practic:[0,1,2],pre:6,precis:[2,3,6],preexist:2,prep_param_list:2,presenc:0,present:[1,2],prevent:1,previou:5,previous:[1,2],principl:1,print:[2,4],prior:2,problem:2,process:[1,6],process_group:6,product:1,prof:6,proof:1,proper:6,properli:[0,2],propos:5,provid:2,pth:2,pure:[0,1],purpos:5,python:[0,1,2],pytorch:[2,5],quick:3,quickli:3,rais:1,randn:[4,6],rang:6,rank:6,rate:[2,5],rather:1,raw:0,readi:0,readjust:2,readm:1,real:2,reason:2,recast:1,receiv:[0,2,6],recent:2,recip:[2,4,6],recogn:[0,1],recommend:[2,5,6],recurs:6,reduc:6,reducer_inst:6,reduct:6,redund:2,reevalu:5,refer:2,referenc:2,reg_inside_mo:5,regard:2,regardless:[0,1],regist:[0,4,6],regular:5,reimplement:4,relat:1,remain:[1,5,6],rememb:2,remov:1,render:1,replac:[0,1,2,5,6],repres:1,represent:4,request:1,requir:[0,1,2,5,6],reserv:[1,2],reset:0,respect:[1,5],respons:[2,6],rest:1,result:[1,2],retain:5,retain_allreduce_buff:6,retain_graph:2,retriev:[0,2],retun:2,review:1,rewrit:1,rho:5,ride:2,right:[1,2],risk:1,run:[1,2,4,5,6],runnabl:[1,2],running_mean:6,running_var:6,safe:0,safeti:2,same:[0,1,2,4,6],sampl:1,saniti:2,save:2,sbn:6,scalar:[1,4],scale:[0,1,4,5,6],scale_factor:2,scale_loss:[0,1],scale_window:2,scaled_loss:[0,1,2],scaler:1,schedul:2,script:[0,1,2,6],second:2,see:[1,2],select:1,self:[0,2],send:[0,1],sens:1,separ:[1,4],session:2,set:[0,1,2,4,5,6],set_devic:6,set_grad_non:5,set_grads_to_non:2,sever:[0,6],sgd:[1,2,5],shape:[2,4],shared_param:6,shell:0,should:[0,1,2,4,6],show:6,side:0,silent:[4,6],similar:6,similarli:0,simpl:[2,6],simpli:1,simul:0,sinc:[4,6],singl:[0,1,2,4,5,6],singleton:4,site:3,situat:1,size:[0,4,6],skip:2,small:[1,6],smaller:[2,6],snippet:0,softmax:1,some:[0,2,3,5,6],sourc:[1,2,4,5,6],special:1,specif:[4,5],specifi:[0,1,4],speed:1,speedup:1,sqrt:4,squar:5,stabil:[1,4,5,6],standard:[2,4],start:[1,3,5],stat:6,state:[1,2],state_dict:2,static_loss_scal:2,statist:[4,6],step:[0,1,2,5],still:[0,1,2,6],stochast:5,store:2,str:1,streamlin:[2,3],stress:6,string:[1,4],strongli:1,subclass:[4,6],subject:1,submodul:2,subtl:2,subtleti:1,subtli:5,suppli:[0,1,2,6],support:[1,5],suppress:1,sure:[0,6],sutskev:5,sync:6,sync_bn_model:6,syncbatchnorm:6,synchron:6,synthesi:0,take:[2,4,6],target:[2,5],technic:2,tell:[0,1],tensor:[0,1,2,4,5,6],term:5,text:4,than:1,thei:[0,1,2,6],them:[0,1,2,4,6],themselv:1,theori:2,therefor:[0,1],thi:[0,1,2,3,4,5,6],thing:[1,2],think:1,those:[0,2],three:1,through:[0,1],time:[1,2,4],toggl:6,tool:1,topic:[0,1],torch:[0,1,2,4,5,6],total:[2,6],touch:0,tough:0,track:6,track_running_stat:6,train:[2,3,4,5,6],transfer:6,transform:4,transpar:2,travers:6,treat:4,treatment:1,tree:[1,6],tricki:[0,1],truth:2,tupl:[2,5],turn:2,two:[2,4],type:[1,2,5],typic:0,under:[0,1],underflow:2,underli:2,understand:2,uniqu:2,unless:1,unlik:[1,4,6],unnecessari:[2,5],unrel:0,unscal:[0,1],unspecifi:[1,2],until:[0,2],unus:1,unwrap:0,updat:[0,1,2,5],update_master_grad:2,upstream:[3,6],usag:[1,5,6],use:[2,5,6],used:[0,1,2,4,5,6],useful:[1,2,6],user:[2,3,6],uses:[0,1,4,6],using:[0,1,2,6],usual:[1,2],util:[0,2,3],valid:2,valu:[1,2,4,5,6],varianc:6,variant:5,variou:1,vector:2,veloc:5,verbos:[1,2],veri:2,versatil:1,version:[1,5],via:[0,2,5],view:2,wai:[1,2],wait:[1,2,6],want:2,wd_after_momentum:5,weight:[1,2,4,5],weight_decai:5,weird:1,well:[0,1,2],were:1,what:[0,1],when:[1,2,4,5,6],whenev:[0,6],where:[1,5,6],wherev:0,whether:[5,6],which:[0,1,2,4,5,6],whitelist:1,whose:[0,2],wide:6,wish:5,within:[0,1,2,4,6],without:[0,1,2,4,5],won:0,word_language_model:2,work:[0,2,6],world:6,would:6,wrap:[0,2,6],wrapper:[1,6],written:5,yet:1,yield:1,you:[0,1,2,4,5,6],your:[0,1,2,4,6],zero:[2,4],zero_grad:[0,2,5]},titles:["Advanced Amp Usage","apex.amp","apex.fp16_utils","Apex (A PyTorch Extension)","apex.normalization.fused_layer_norm","apex.optimizers","apex.parallel"],titleterms:{"case":1,"function":[0,6],For:1,accumul:0,across:0,advanc:[0,1],almost:1,amp:[0,1],apex:[1,2,3,4,5,6],api:1,autograd:0,automat:2,backward:0,batch:0,clip:0,custom:0,data:0,defin:0,desir:0,differ:0,extens:3,forc:0,fp16:1,fp16_optim:1,fp16_util:2,fp32:1,fused_layer_norm:4,gan:0,gradient:0,guid:1,have:0,indic:3,initi:0,iter:0,layer:0,loss:[0,2],manag:2,manual:2,master:2,mix:1,model:0,multipl:0,normal:4,old:1,opt_level:1,optim:[0,5],option:0,parallel:6,param:2,paramet:2,particular:0,pass:0,per:0,precis:1,properti:1,pytorch:3,recommend:1,scale:2,scaler:0,tabl:3,train:1,transit:1,type:0,typic:1,unifi:1,usag:0,use:[0,1],user:[0,1],util:6}})